!function(e,t){function l(e){return e.on("selectstart",!1).attr("unselectable","on").css("userSelect","none")}function n(e){var t=[],l=parseInt(e/3600),n=parseInt((e-3600*l)/60),r=Math.floor(e-(3600*l+60*n));return l&&t.push(10>l?"0"+l:l),t.push(10>n?"0"+n:n),t.push(10>r?"0"+r:r),t.join(":")}function r(e){t(document).trigger(e)}function i(e,t){return t=t?"-"+t+"-":"-",e.attr("id",a+t+s).addClass(a+t.substring(0,t.length-1))}function u(e){for(var t=[],l=1;l<arguments.length;l++)t.push(arguments[l]);return t.forEach(function(t){e.addClass(a+"-"+t)}),e}function o(e){for(var t=[],l=1;l<arguments.length;l++)t.push(arguments[l]);return t.forEach(function(t){e.removeClass(a+"-"+t)}),e}function m(e,n){var m=this;m.id=s,m.name=a,m.version="2.0.3",m.element=e[0],m.element.controls=!1,e.on("ended",function(){o(m.html.wrapper,"played","paused"),u(m.html.wrapper,"ended"),m.update(!0);var e={type:"FancyPlayer:ended",player:m.element,api:m,id:m.id};r(e),m.onEnd()}).on("pause",function(){m.update(!0),clearInterval(d.played),u(m.html.wrapper,"paused"),o(m.html.wrapper,"played","ended");var e=new t.Event({type:"FancyPlayer:pause",player:m.element,api:m,id:m.id});r(e),m.html.timeSliderCurrent.stop(!0),m.html.timeSliderBuffer.stop(!0),m.onPause()}).on("play",function(){u(m.html.wrapper,"played"),o(m.html.wrapper,"paused","ended");var e={type:"FancyPlayer:play",player:m.element,api:m,id:m.id};r(e),m.update(),d.played=setInterval(function(){m.update()},1e3),m.onPlay()}).on("volumechange",function(){function e(e){m.html.volumeSliderCurrent.css(m.html.volumeSliderFull.height()>m.html.volumeSliderFull.width()?{top:100-e+"%"}:{width:e+"%"})}console.log("change volume"),m.volume=100*m.element.volume,m.element.muted||0===m.volume?(u(m.html.wrapper,"muted"),e(0)):(o(m.html.wrapper,"muted"),e(m.volume));var t={type:"FancyPlayer:volume",player:m.element,api:m,id:m.id};r(t),m.onVolume()}).on("contextmenu",function(e){return e.preventDefault(),!1}).on("click",function(){m.toggle()}).on("dblclick",function(){m.fullscreen()}),m.onEnd=function(){},m.onPlay=function(){},m.onPause=function(){},m.onVolume=function(){},m.settings=t.extend({},Fancy.settings[a],n),m.html={wrapper:u(i(t("<div/>")),"theme-"+m.settings.theme),controls:i(t("<div/>"),"controls"),left:i(t("<div/>"),"controls-left"),right:i(t("<div/>"),"controls-right"),play:u(i(t("<div/>"),"play"),"control"),fullscreen:u(i(t("<div/>"),"fullscreen"),"control"),timeCurrent:i(t("<div/>"),"time-current"),timeFull:i(t("<div/>"),"time-full"),timePopout:i(t("<div/>"),"time-popout"),timeSlider:i(t("<div/>"),"time-slider"),timeSliderCurrent:i(t("<div/>"),"time-slider-current"),timeSliderBuffer:i(t("<div/>"),"time-slider-buffer"),timeSliderFull:i(t("<div/>"),"time-slider-full"),volume:i(t("<div/>"),"volume"),volumeSlider:i(t("<div/>"),"volume-slider"),volumeSliderCurrent:i(t("<div/>"),"volume-slider-current"),volumeSliderFull:i(t("<div/>"),"volume-slider-full"),mute:u(i(t("<div/>"),"volume-mute"),"control"),loop:u(i(t("<div/>"),"loop"),"control")},e.wrap(m.html.wrapper),m.html.wrapper=e.parent(),m.html.wrapper.append(m.html.controls),m.html.controls.append(m.html.left),m.html.left.append(m.html.play),m.settings.loopable&&m.html.left.append(m.html.loop),m.html.left.append(m.html.timeCurrent),m.html.left.append(m.html.timeFull),m.html.controls.append(m.html.timeSlider),m.html.controls.append(m.html.right),m.html.controls.append(m.html.timePopout),m.html.right.append(m.html.volume),m.html.right.append(m.html.fullscreen),m.html.timeSlider.append(m.html.timeSliderFull),m.html.timeSliderFull.append(m.html.timeSliderBuffer),m.html.timeSliderFull.append(m.html.timeSliderCurrent),m.html.volume.append(m.html.mute),m.html.volume.append(m.html.volumeSlider),m.html.volumeSlider.append(m.html.volumeSliderFull),m.html.volumeSliderFull.append(m.html.volumeSliderCurrent),h||(h=!0,Fancy.version(m)),m.duration=0,m.volume=m.element.volume,m.muted=m.element.muted,m.settings.start&&(m.seek(m.settings.start),m.html.timerSliderCurrent.css("marginLeft",m.settings.start),m.html.timeSliderBuffer.css("marginLeft",m.settings.start)),m.play(),m.settings.autoplay||m.pause(),m.eventListener(),l(m.html.wrapper),e.data(a,m);{var c=e.height(),p=e.height();screen.height/screen.width}return screen.width>screen.height?e.width(100-p/screen.width*100+"%"):e.height(100-c/screen.height*100+"%"),m}if("undefined"==typeof Fancy)return void console.error("Fancy is required");var s=1,a="FancyPlayer",d=[],h=!1;m.api=m.prototype={},m.api.pause=function(){return this.element.pause(),this},m.api.play=function(){return this.element.ended?(this.reset(),this.play()):this.element.play(),this},m.api.seek=function(e){var t=this;return clearTimeout(d.seek),d.seek=setInterval(function(){4==t.element.readyState&&(clearTimeout(d.seek),t.element.currentTime=e,t.update(!0))},10),t},m.api.update=function(e){var t=this;return t.currentTime=t.element.currentTime,t.duration=t.element.duration||0,e?t.html.timeSliderCurrent.stop(!0).width((t.currentTime-t.settings.start)/t.duration*100+"%"):4==t.element.readyState&&(t.buffered=[t.element.buffered.start(0),t.element.buffered.end(0)],t.played=[t.settings.start,t.element.currentTime],t.html.timeSliderCurrent.animate({width:(t.currentTime+1-t.settings.start)/t.duration*100+"%"},1e3,"linear"),t.html.timeSliderBuffer.animate({width:(t.buffered[1]-t.settings.start)/t.duration*100+"%"},1e3,"linear")),t.html.timeFull.html(n(t.duration)),t.html.timeCurrent.html(n(t.currentTime)),this},m.api.toggle=function(){var e=this;return e.element.paused?e.play():e.pause(),this},m.api.eventListener=function(){var e=this;e.html.play.on("click",function(){e.toggle()});var l=0;return clearInterval(l),l=setInterval(function(){4==e.element.readyState&&(clearInterval(l),e.update())},50),e.html.fullscreen.on("click",function(){e.fullscreen()}),e.html.mute.on("click",function(){e.element.muted=!e.element.muted,e.muted=e.element.muted}),e.html.timeSlider.on("click",function(t){e.seek(e.calcTime(t)),e.update(!0)}),e.html.volumeSliderFull.on("click",function(t){e.setVolume(e.html.volumeSliderFull.height()>e.html.volumeSliderFull.width()?(e.html.volumeSliderFull.height()-t.offsetY)/e.html.volumeSliderFull.height()*100:100*t.offsetX/e.html.volumeSliderFull.width())}),e.html.loop.on("click",function(t){t.preventDefault(),t.stopPropagation(),e.html.loop.toggleClass("checked"),e.toggleLoop()}),e.html.wrapper.on("mousemove",function(){e.showControls(),clearTimeout(d.hover),d.hover=setTimeout(function(){t("#"+e.html.controls.attr("id")+":hover").length||e.hideControls()},1500)}),Fancy.swipe&&(Fancy(e.html.volumeSliderFull).swipe({onMouseMove:function(l){if(t(l.target).is(e.html.volumeSliderFull)||t(l.target).is(e.html.volumeSliderCurrent)||t(l.target).is(e.html.volumeSlider))if(e.html.volumeSliderFull.height()>e.html.volumeSliderFull.width()){var n=(e.html.volumeSliderFull.height()-l.offsetY)/e.html.volumeSliderFull.height()*100;n=n>100?100:0>n?0:n,e.setVolume(n)}else{var n=100*l.offsetX/e.html.volumeSliderFull.width();n=n>100?100:0>n?0:n,e.setVolume(n)}else{var r={top:l.pageY,left:l.pageX},i=e.html.volumeSliderFull.offset();e.html.volumeSliderFull.height()>e.html.volumeSliderFull.width()?r.top>i.top?e.setVolume(100):r.top<i.top&&e.setVolume(0):r.left>i.left?e.setVolume(100):r.left<i.left&&e.setVolume(0)}}}),Fancy(e.html.timeSlider).swipe({onMouseMove:function(t){e.seek(e.element.duration*t.offsetX/e.html.timeSlider.width()),e.update(!0)}})),e.html.timeSlider.on("mousemove",function(t){e.html.timePopout.show().html(e.getTime(t));var l=t.offsetX+e.html.timeSlider.offset().left-e.html.wrapper.position().left,n=e.html.timePopout.outerWidth();l=Math.min(l,e.html.timeSlider.width()+e.html.timeSlider.offset().left-n/2-5-e.html.wrapper.position().left),l=Math.max(l,n/2+5),e.html.timePopout.css({left:l})}).on("mouseout",function(){e.html.timePopout.fadeOut()}),t(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?u(e.html.wrapper,"fullscreen"):o(e.html.wrapper,"fullscreen")}),this},m.api.fullscreen=function(e){if(e&&"toggle"!==e||(e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?"leave":"enter"),"enter"===e){var t=this.html.wrapper[0];t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}else"leave"===e?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():console.error("Mode "+e+" not supported");return this},m.api.setVolume=function(e){return"number"==typeof e&&(this.element.muted=!1,this.element.volume=e/100),this},m.api.reset=function(){return this.element.load(),this.seek(this.settings.start),this.html.timeSliderCurrent.width(0),this},m.api.toggleLoop=function(e){this.element.loop="undefined"!=typeof e?e?!0:!1:!this.element.loop},m.api.showControls=function(){u(this.html.wrapper,"controls-show")},m.api.hideControls=function(){o(this.html.wrapper,"controls-show")},m.api.calcTime=function(e){return this.element.duration*e.offsetX/this.html.timeSlider.width()},m.api.getTime=function(e){return n(this.calcTime(e))},Fancy.settings[a]={autoplay:!1,start:0,theme:"default",loopable:!1},Fancy.player=!0,Fancy.api.player=function(e){var t=this.get(a);if(t&&t.length)for(var l in t)"undefined"==typeof t[l]&&(t[l]=new m(this.element[l],e));return t?t:new m(this.element,e)}}(window,jQuery);
