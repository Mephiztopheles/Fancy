!function(e,n){function t(e,t){var o=this;o.name=i,o.id=s,o.element=e,o.settings=n.extend({},Fancy.settings[i],t),a||(a=!0,Fancy.version(o)),this.init(),s++}if("function"==typeof n){if("undefined"==typeof Fancy)return void console.error("Fancy is required");var i="FancyMenu",s=0,a=!1;t.api=t.prototype={},t.api.version="2.0.2",t.api.init=function(){var e=this;e.createMenu(),e.element.addClass(this.name+"-trigger"),e.element.data(i,e),e.element.on("mousedown",function(n){e.onOpen(n)}).on("contextmenu",function(n){2===e.settings.button&&n.preventDefault(),n.stopPropagation()})},t.api.createMenu=function(){var e=this,t=n("<div/>",{id:i+"-wrapper"}).attr("unselectable","on").css("user-select","none").on("selectstart",!1),s=n("<div/>",{id:i+"-inner"}),a=n("<ul/>",{id:i+"-menu"});t.append(s.append(a));for(var o=0;o<e.settings.menu.length;o++){var u=e.settings.menu[o],c=n("<li/>",{id:i+"-menu-"+o,"class":i+"-menu-element"}).data("name",o);c.append(n("<span/>",{id:i+"-menu-"+o+"-icon","class":i+"-menu-icon "+u.icon})),c.append(n("<span/>",{id:i+"-menu-"+o+"-text","class":i+"-menu-text",html:u.title||u.name||o})),a.append(c)}this.menu=t},t.api.onOpen=function(e){var t=this;e.button==this.settings.button&&(this.close(),this.createMenu(),n("body").append(this.menu),n("."+i+"-menu-element").on("click",function(e){var i=n(this).data("name");t.settings.menu[i].click&&t.settings.menu[i].click.call(t,e,i,n(this))}),n(document).on("mousedown."+i+"-"+t.id,function(e){(e.button!==t.settings.button||!n(e.target).closest(t.element).length&&!n(e.target).is(t.element))&&(n(e.target).is(t.menu)||n(e.target).closest(t.menu).length||t.close())}),this.menu.css({left:e.pageX+10,top:e.pageY+10}))},t.api.close=function(){this.menu.remove(),n(document).unbind("."+i+"-"+this.id),this.settings.onClose.call(this)},Fancy.menu=!0,Fancy.settings[i]={menu:{},button:2,onClose:function(){}},Fancy.api.menu=function(e){var n=this.get(i);if(n&&n.length)for(var s=0;s<n.length;s++)"undefined"==typeof n[s]&&(n[s]=new t(this.element[s],e));return n?n:new t(this.element,e)}}}(window,jQuery);
