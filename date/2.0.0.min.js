(function(e,t){function u(e,t){var n,r=0;for(k in e){if(r==t)n=k;r++}return n}function a(e,t){var r=this;var i=n(e);if(!i||!i.length||i[0].nodeName!="INPUT"){console.error(s+" needs an input to be bound to!");return}r.name=s;r.version="2.0.0";r.settings=n.extend({},a.settings,t);r.visible=false;r.calculate={day:24*60*60*1e3,hour:60*60*1e3,minute:60*1e3,second:1e3};r.element=i;r.enable=function(){};r.disable=function(){};r.today=new Date;r.current=new Date;r.selected=this.decode(i.val());r.init();return r}if(typeof Fancy=="undefined"){console.error("Fancy is required");return}var n=t,r=Fancy,i=1,s="FancyDate",o=false;a.api=a.prototype={};a.api.init=function(){var e=this;if(!o){o=true;r.version(e)}this.html={wrapper:n("<div/>",{id:e.name+"-wrapper"}),dialog:n("<div/>",{id:e.name+"-dialog"}).attr("onselectstart",function(){return false}),inner:n("<div/>",{id:e.name+"-inner"}),previous:n("<div/>",{id:e.name+"-previous","class":e.name+"-button"}),next:n("<div/>",{id:e.name+"-next","class":e.name+"-button"}),title:n("<div/>",{id:e.name+"-title"}),year:n("<span/>",{id:e.name+"-year"}),month:n("<span/>",{id:e.name+"-month"}),header:n("<div/>",{id:e.name+"-header"}),body:n("<div/>",{id:e.name+"-body"}),footer:n("<div/>",{id:e.name+"-footer"}),close:n("<div/>",{id:e.name+"-close","class":e.name+"-button",html:e.translate("button","close")}),today:n("<div/>",{id:e.name+"-today","class":e.name+"-button",html:e.translate("button","today")}),clear:n("<div/>",{id:e.name+"-clear","class":e.name+"-button",html:e.translate("button","clear")}),calendar:n("<div/>",{id:e.name+"-calendar"}),days:[],rows:[]};e.element.on("focus",function(){if(!e.visible)e.show()}).addClass(e.name+"-element").data(e.name,e)};a.api.show=function(){function t(){e.html.dialog.show();e.visible=true;e.create()}var e=this;n("body").append(e.html.wrapper).addClass(e.name);e.html.wrapper.append(e.html.dialog);e.html.dialog.append(e.html.inner);e.html.inner.append(e.html.header).append(e.html.body).append(e.html.footer);e.html.header.append(e.html.previous.html(n("<span/>"))).append(e.html.title).append(e.html.next.html(n("<span/>")));e.html.body.html(e.html.calendar);e.html.footer.html(e.html.close).append(e.html.today).append(e.html.clear);e.html.title.html(e.html.month.html(e.translate("month",e.current.getMonth()))).append(e.html.year.html(e.current.getFullYear()));e.html.dialog.hide();if(e.settings.animated){setTimeout(function(){t();e.html.dialog.addClass("show").removeClass("hide")})}else{t()}return e};a.api.hide=function(){function t(){e.visible=false;e.html.wrapper.remove();e.html.calendar.html("");e.html.header.html("");e.html.title.html("");n("body").removeClass(e.name)}var e=this;e.element.unbind("."+e.name+":prevent");if(e.settings.animated){setTimeout(t,300);e.html.dialog.addClass("hide").removeClass("show")}else{t()}return e};a.api.update=function(){var e=this;e.html.calendar.html("");e.html.title.html(e.html.month.html(e.translate("month",e.current.getMonth()))).append(e.html.year.html(e.current.getFullYear()));e.create()};a.api.create=function(){var t=this,r=new Date(t.current.getFullYear(),t.current.getMonth(),1),i=1,s=0;if(r.getDay()!=1&&r.getDay()!=0){var o=new Date(t.current.getFullYear(),t.current.getMonth(),0);r=new Date(t.current.getFullYear(),t.current.getMonth()-1,o.getDate()-r.getDay()+2)}else if(r.getDay()==0){var o=new Date(t.current.getFullYear(),t.current.getMonth(),0);r=new Date(t.current.getFullYear(),t.current.getMonth()-1,o.getDate()-5)}else{var o=new Date(t.current.getFullYear(),t.current.getMonth(),0);r=new Date(t.current.getFullYear(),t.current.getMonth()-1,o.getDate()-6)}t.html.days=[];t.html.rows=[];t.html.rows[1]=n("<div/>",{id:t.name+"-row-1","class":t.name+"-row"});t.html.calendar.append(t.html.rows[1]);var u=0;while(u<7){u++;var a=n("<div/>",{id:t.name+"-day-name"+u,"class":t.name+"-day",html:t.translate("day",u-1)});t.html.rows[1].append(a)}while(i<7){i++;t.html.rows[i]=n("<div/>",{id:t.name+".row-"+i,"class":t.name+"-row"});t.html.calendar.append(t.html.rows[i]);var f=0;while(f<7){f++;s++;var a=n("<div/>",{id:t.name+"-day-"+s,"class":t.name+"-day"+" "+t.name+"-button",html:r.getDate()}).data("date",r);if(r.getMonth()!=t.current.getMonth())a.addClass(t.name+"-day-extern");if(r.getMonth()==t.today.getMonth()&&r.getDate()==t.today.getDate()&&r.getFullYear()==t.today.getFullYear())a.addClass(t.name+"-day-today");r=new Date(r.getTime()+t.calculate.day);t.html.days.push(a);t.html.rows[i].append(a)}}if(t.element.val()){var l=t.decode(t.element.val());n("."+t.name+"-day").filter(function(){return n(this).data("date")==l.toString()}).addClass(t.name+"-active")}var c=t.html.days[0].width();n(t.html.days).each(function(){n(this).css({width:c})});t.html.dialog.css({marginTop:(e.innerHeight-t.html.dialog.outerHeight())/2,marginLeft:(e.innerWidth-t.html.dialog.outerWidth())/2});t.html.title.css({width:t.html.header.outerWidth()-t.html.previous.outerWidth()-t.html.next.outerWidth()-parseInt(t.html.header.css("borderLeft"))-parseInt(t.html.header.css("borderRight"))});t.addEventListener();return t};a.api.addEventListener=function(){var e=this;for(var t in e.html.days){n(e.html.days[t]).on("click",function(){e.select(new Date(n(this).data("date")))})}e.html.clear.unbind("click").on("click",function(){e.element.val("");e.selected=false;e.current=e.today;e.hide()});e.html.dialog.unbind("."+e.name).on("selectstart."+e.name,function(e){"use strict";e.preventDefault()});e.html.close.unbind("click").on("click",function(){e.hide()});e.html.today.unbind("click").on("click",function(){e.select(e.today);e.current=e.today;e.hide()});e.html.next.unbind("click").on("click",function(){e.current=new Date(e.current.getFullYear(),e.current.getMonth()+1,1);e.update()});e.html.previous.unbind("click").on("click",function(){e.current=new Date(e.current.getFullYear(),e.current.getMonth()-1,1);e.update()});e.html.wrapper.unbind("click").on("click",function(t){if(n(t.target).is(e.html.wrapper)){e.hide()}});e.element.unbind("input."+e.name).on("input."+e.name,function(e){var t=n(this).val();n(this).val(t.substring(0,t.length-1))});return e};a.api.select=function(e){var t=this;t.element.val(t.encode(e));t.selected=e;t.hide();return t};a.api.encode=function(e,t){var n=this,t=t||n.settings.format;return t.replace("dd",e.getDate()<10?"0"+e.getDate():e.getDate()).replace("mm",e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1).replace("yyyy",e.getFullYear())};a.api.decode=function(e){var t=this;var n={d:parseInt(e.substring(t.settings.format.indexOf("dd"),t.settings.format.indexOf("dd")+2)),m:parseInt(e.substring(t.settings.format.indexOf("mm"),t.settings.format.indexOf("mm")+2))-1,y:parseInt(e.substring(t.settings.format.indexOf("yyyy"),t.settings.format.indexOf("yyyy")+4))};return new Date(n.y,n.m,n.d)};a.api.translate=function(e,t){var n="",r=a.translation[navigator.language]?navigator.language:"en";n=a.translation[r][e];if(typeof n[0]=="undefined"&&typeof t=="number"){t=u(n,t)}if(n)n=a.translation[r][e][t];return n};a.settings={format:"dd.mm.yyyy",animated:true};a.translation={de:{month:["Januar","Februar","M&auml;rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],day:{mon:"Mo",tue:"Di",wen:"Mi",thu:"Do",fri:"Fr",sat:"Sa",sun:"So"},button:{close:"Schlie&szlig;en",today:"Heute",clear:"L&ouml;schen"}},en:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],day:{mon:"Mon",tue:"Tue",wen:"Wed",thu:"Thu",fri:"Fri",sat:"Sat",sun:"Sun"},button:{close:"Close",today:"Today",clear:"Clear"}}};r.api.date=function(e){var t=this.get(s);if(t&&t.length){for(var n in t){if(typeof t[n]=="undefined"){t[n]=new a(this.element[n],e)}}}if(!t)return new a(this.element,e);else return t}})(window,jQuery)