!function(e,t){function n(e,t){var n,a=0;for(var r in e)a==t&&(n=r),a++;return n}function a(e,n){var r=this,l=t(e);return l&&l.length&&"INPUT"==l[0].nodeName?(r.name=i,r.version="2.0.2",r.settings=t.extend({},a.settings,n),r.visible=!1,r.calculate={day:864e5,hour:36e5,minute:6e4,second:1e3},r.element=l,r.enable=function(){},r.disable=function(){},r.today=r.decode(r.encode(new Date)),r.current=r.decode(l.val()?l.val():r.encode(new Date)),r.selected=r.decode(l.val()),r.init(),r):void console.error(i+" needs an input to be bound to!")}if("undefined"==typeof Fancy)return void console.error("Fancy is required");var r=Fancy,i="FancyDate",l=!1;a.api=a.prototype={},a.api.init=function(){var e=this;l||(l=!0,r.version(e)),this.html={wrapper:t("<div/>",{id:e.name+"-wrapper"}),dialog:t("<div/>",{id:e.name+"-dialog"}).attr("onselectstart",function(){return!1}),inner:t("<div/>",{id:e.name+"-inner"}),previous:t("<div/>",{id:e.name+"-previous","class":e.name+"-button"}),previousArrow:t("<div/>",{"class":e.name+"-arrow"}),next:t("<div/>",{id:e.name+"-next","class":e.name+"-button"}),nextArrow:t("<div/>",{"class":e.name+"-arrow"}),title:t("<div/>",{id:e.name+"-title"}),year:t("<span/>",{id:e.name+"-year"}),month:t("<span/>",{id:e.name+"-month"}),header:t("<div/>",{id:e.name+"-header"}),body:t("<div/>",{id:e.name+"-body"}),footer:t("<div/>",{id:e.name+"-footer"}),close:t("<div/>",{id:e.name+"-close","class":e.name+"-button",html:e.translate("button","close")}),today:t("<div/>",{id:e.name+"-today","class":e.name+"-button",html:e.translate("button","today")}),clear:t("<div/>",{id:e.name+"-clear","class":e.name+"-button",html:e.translate("button","clear")}),calendar:t("<div/>",{id:e.name+"-calendar"}),days:[],rows:[]},e.element.on("focus",function(){!e.visible&&e.settings.query(e.element)&&e.show()}).addClass(e.name+"-element").data(e.name,e)},a.api.show=function(){function e(){n.html.dialog.show(),n.visible=!0,n.settings.onShow.call(n),n.create()}var n=this;return this.settings.free?(t("body").append(n.html.wrapper).addClass(n.name),n.html.wrapper.append(n.html.dialog)):t("body").append(n.html.dialog).addClass(n.name),n.html.dialog.append(n.html.inner),n.html.inner.append(n.html.header).append(n.html.body).append(n.html.footer),n.html.header.append(n.html.previous.append(n.html.previousArrow)).append(n.html.title).append(n.html.next.append(n.html.nextArrow)),n.html.body.html(n.html.calendar),n.html.footer.html(n.html.close).append(n.html.today).append(n.html.clear),n.html.title.append(n.html.month.html(n.translate("month",n.current.getMonth()))).append(n.html.year.html(n.current.getFullYear())),n.html.dialog.hide(),n.settings.free?n.html.wrapper.unbind("."+i).on("click."+i,function(e){t(e.target).is(n.html.wrapper)&&n.hide()}):t(document).unbind("."+i).on("click."+i,function(e){t(e.target).is(n.element)||t(e.target).closest("#"+i+"-dialog").length||t(e.target).is("#"+i+"-dialog")||n.hide()}),n.settings.animated?setTimeout(function(){e(),n.html.dialog.addClass("show").removeClass("hide")}):e(),n},a.api.hide=function(){function e(){n.html.wrapper.remove(),n.html.dialog.remove(),n.html.calendar.html(""),n.html.header.html(""),n.html.title.html(""),n.element.unbind("."+i+":prevent"),n.element[0].blur(),n.visible=!1,n.settings.onClose.call(n),t("body").removeClass(n.name)}var n=this;return n.element.unbind("."+n.name+":prevent"),console.trace(),n.settings.animated?(setTimeout(e,300),n.html.dialog.addClass("hide").removeClass("show")):e(),n},a.api.update=function(){var e=this;e.html.calendar.html(""),e.html.title.html(e.html.month.html(e.translate("month",e.current.getMonth()))).append(e.html.year.html(e.current.getFullYear())),e.create()},a.api.create=function(){var n=this,a=new Date(n.current.getFullYear(),n.current.getMonth(),1),r=1,i=0;if(1!=a.getDay()&&0!=a.getDay()){var l=new Date(n.current.getFullYear(),n.current.getMonth(),0);a=new Date(n.current.getFullYear(),n.current.getMonth()-1,l.getDate()-a.getDay()+2)}else if(0==a.getDay()){var l=new Date(n.current.getFullYear(),n.current.getMonth(),0);a=new Date(n.current.getFullYear(),n.current.getMonth()-1,l.getDate()-5)}else{var l=new Date(n.current.getFullYear(),n.current.getMonth(),0);a=new Date(n.current.getFullYear(),n.current.getMonth()-1,l.getDate()-6)}n.html.days=[],n.html.rows=[],n.html.rows[1]=t("<div/>",{id:n.name+"-row-1","class":n.name+"-row"}),n.html.calendar.append(n.html.rows[1]);for(var o=0;7>o;){o++;var d=t("<div/>",{id:n.name+"-day-name"+o,"class":n.name+"-day",html:n.translate("day",o-1)});n.html.rows[1].append(d)}for(;7>r;){r++,n.html.rows[r]=t("<div/>",{id:n.name+".row-"+r,"class":n.name+"-row"}),n.html.calendar.append(n.html.rows[r]);for(var s=0;7>s;){s++,i++;var d=t("<div/>",{id:n.name+"-day-"+i,"class":n.name+"-day "+n.name+"-button",html:a.getDate()}).data("date",a);a.getMonth()!=n.current.getMonth()&&d.addClass(n.name+"-day-extern"),a.getMonth()==n.today.getMonth()&&a.getDate()==n.today.getDate()&&a.getFullYear()==n.today.getFullYear()&&d.addClass(n.name+"-day-today"),a=new Date(a.getTime()+n.calculate.day),n.html.days.push(d),n.html.rows[r].append(d)}}if(n.element.val()){var m=n.decode(n.element.val());t("."+n.name+"-day").filter(function(){return t(this).data("date")==m.toString()}).addClass(n.name+"-active")}var h=n.html.days[0].width();return t(n.html.days).each(function(){t(this).css({width:h})}),this.html.dialog.css(this.settings.free?{marginTop:(e.innerHeight-this.html.dialog.outerHeight())/2,marginLeft:(e.innerWidth-this.html.dialog.outerWidth())/2}:{position:"absolute",left:n.element.offset().left,top:n.element.offset().top+n.element.outerHeight()}),n.html.title.css({width:n.html.header.outerWidth()-n.html.previous.outerWidth()-n.html.next.outerWidth()-parseInt(n.html.header.css("borderLeft"))-parseInt(n.html.header.css("borderRight"))}),n.addEventListener(),n},a.api.addEventListener=function(){for(var e=this,n=0;n<e.html.days.length;n++)t(e.html.days[n]).on("click",function(){e.select(new Date(t(this).data("date")))});return e.element.on("blur."+i,function(t){setTimeout(function(){e.html.dialog.is(":visible")&&!t.relatedTarget?e.element[0].focus():e.hide()},1)}),e.html.clear.unbind("click").on("click",function(){e.element.val(""),e.selected=!1,e.current=e.today,e.hide()}),e.html.dialog.unbind("."+e.name).on("selectstart."+e.name,function(e){"use strict";e.preventDefault()}),e.html.close.unbind("click").on("click",function(){e.hide()}),e.html.today.unbind("click").on("click",function(){e.select(e.today),e.current=e.today,e.hide()}),e.html.next.unbind("click").on("click",function(){e.current=new Date(e.current.getFullYear(),e.current.getMonth()+1,1),e.update()}),e.html.previous.unbind("click").on("click",function(){e.current=new Date(e.current.getFullYear(),e.current.getMonth()-1,1),e.update()}),e.html.wrapper.unbind("click").on("click",function(n){t(n.target).is(e.html.wrapper)&&e.hide()}),e.element.unbind("input."+e.name).on("input."+e.name,function(){var e=t(this).val();t(this).val(e.substring(0,e.length-1))}),e},a.api.select=function(e){var t=this;return t.element.val(t.encode(e)),t.selected=e,t.current=e,"function"==typeof t.settings.onSelect&&t.settings.onSelect(t.selected),t.hide(),t},a.api.encode=function(e,t){var n=this;return t=t||n.settings.format,t.replace("dd",e.getDate()<10?"0"+e.getDate():e.getDate()).replace("mm",e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1).replace("yyyy",e.getFullYear())},a.api.decode=function(e){var t=this,n={d:parseInt(e.substring(t.settings.format.indexOf("dd"),t.settings.format.indexOf("dd")+2)),m:parseInt(e.substring(t.settings.format.indexOf("mm"),t.settings.format.indexOf("mm")+2))-1,y:parseInt(e.substring(t.settings.format.indexOf("yyyy"),t.settings.format.indexOf("yyyy")+4))};return new Date(n.y,n.m,n.d)},a.api.translate=function(e,t){var r=a.translation[navigator.language]?navigator.language:"en",i=a.translation[r][e];return"undefined"==typeof i[0]&&"number"==typeof t&&(t=n(i,t)),i&&(i=a.translation[r][e][t]),i},a.settings={format:"dd.mm.yyyy",animated:!0,onShow:function(){},onClose:function(){}},a.translation={de:{month:["Januar","Februar","M&auml;rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],day:{mon:"Mo",tue:"Di",wen:"Mi",thu:"Do",fri:"Fr",sat:"Sa",sun:"So"},button:{close:"Schlie&szlig;en",today:"Heute",clear:"L&ouml;schen"}},en:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],day:{mon:"Mon",tue:"Tue",wen:"Wed",thu:"Thu",fri:"Fri",sat:"Sat",sun:"Sun"},button:{close:"Close",today:"Today",clear:"Clear"}}},r.date=!0,r.api.date=function(e){var t=this.get(i);if(t&&t.length)for(var n=0;n<t.length;n++)"undefined"==typeof t[n]&&(t[n]=new a(this.element[n],e));return t?t:new a(this.element,e)}}(window,jQuery);
